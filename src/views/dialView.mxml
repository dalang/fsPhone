<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
		xmlns:s="library://ns.adobe.com/flex/spark" title="dialView">
	<fx:Declarations>
		<!-- 将非可视元素（例如服务、值对象）放在此处 -->
	</fx:Declarations>
	<fx:Script>
		<![CDATA[
			static private var tmpChr:String;
			static private var keyTimestamp:Date;
			static private var keyCount:int = 0;
			private const KEY_INTERVAL:int = 500;
			private const KEY_TABLE:Object = {'2':"ABC", '3':"DEF", '4':"GHI", '5':"JKL", '6':"MNO", '7':"PQRS", '8':"TUV", '9':"WXYZ"};

			private function doCallChar(chr:String):void {
				if (chr == tmpChr && (null != KEY_TABLE[chr]) && (((new Date()).time - keyTimestamp.time) < KEY_INTERVAL))
				{
					var tmp:String;
					keyCount = (keyCount + 1) % KEY_TABLE[chr].length;
					if (keyCount > 0)
						tmp = KEY_TABLE[chr].charAt(keyCount - 1)
					else
						tmp = chr;
					dialnumTxt.text = dialnumTxt.text.substr(0, (dialnumTxt.text.length - 1)) + tmp;
				}
				else
				{
					keyCount = 0;
					dialnumTxt.text += chr;
				}
				tmpChr = chr;
				keyTimestamp = new Date();
			}
			
			private function doCall():void {
				this.addEventListener('doCall', onCall);
				dispatchEvent(new Event('doCall'));
			}
			
			private function onCall(event:Event):void {
				dialnumTxt.text = "";
			}
			
		]]>
	</fx:Script>
	<s:TextInput id="dialnumTxt" x="0" y="0" width="320" height="64" editable="false"/>
	<s:VGroup x="0" y="62" width="320" height="339" gap="0" horizontalAlign="center"
			  verticalAlign="middle">
		<s:HGroup width="300" height="60" gap="12" horizontalAlign="center" verticalAlign="middle">
			<s:Button width="30%" label="1" click="doCallChar('1')"/>
			<s:Button width="30%" label="2 ABC" click="doCallChar('2')"/>
			<s:Button width="30%" label="3 DEF" click="doCallChar('3')"/>
		</s:HGroup>
		<s:HGroup width="300" height="60" gap="12" horizontalAlign="center" verticalAlign="middle">
			<s:Button width="30%" label="4 GHI" click="doCallChar('4')"/>
			<s:Button width="30%" label="5 JKL" click="doCallChar('5')"/>
			<s:Button width="30%" label="6 MNO" click="doCallChar('6')"/>
		</s:HGroup>
		<s:HGroup width="300" height="60" gap="12" horizontalAlign="center" verticalAlign="middle">
			<s:Button width="30%" label="7 PQRS" click="doCallChar('7')"/>
			<s:Button width="30%" label="8 TUV" click="doCallChar('8')"/>
			<s:Button width="30%" label="9 WXYZ" click="doCallChar('9')"/>
		</s:HGroup>
		<s:HGroup width="300" height="60" gap="12" horizontalAlign="center" verticalAlign="middle">
			<s:Button width="30%" label="*" click="doCallChar('*')"/>
			<s:Button width="30%" label="0 +" click="doCallChar('0')"/>
			<s:Button width="30%" label="#" click="doCallChar('#')"/>
		</s:HGroup>
		<s:HGroup width="300" height="60" gap="0" horizontalAlign="center" verticalAlign="middle">
			<s:Button width="25%" label="record"/>
			<s:Button width="40%" label="call" click="doCall()"/>
			<s:Button width="25%" label="backspace"/>
		</s:HGroup>
	</s:VGroup>
</s:View>
